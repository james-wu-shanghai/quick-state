<?xml version="1.0" encoding="UTF-8"?>
<!--
    Auto-forward state machine configuration file
    Demonstrates the usage of autoMoveForward feature
-->
<state-machine name="autoMoveForwardMachine">
    <!-- Define initial state -->
    <state name="INIT">
        <!-- Start action with autoMoveForward="true", will automatically execute the only action in next state after completion -->
        <action name="start" ref="startAction" autoMoveForward="true">
            <next-state response="SUCCESS" state="PROCESSING"/>
            <next-state response="FAILED" state="FAIL"/>
        </action>
    </state>
    
    <!-- Define processing state -->
    <state name="PROCESSING">
        <!-- This state has only one action, which will be automatically executed when entered from INIT state -->
        <action name="process" ref="processAction">
            <next-state response="DONE" state="COMPLETING"/>
        </action>
    </state>
    
    <!-- Define completing state -->
    <state name="COMPLETING">
        <!-- Complete action, also set autoMoveForward="true" -->
        <action name="complete" ref="completeAction" autoMoveForward="true">
            <next-state response="SUCCESS" state="COMPLETED"/>
        </action>
    </state>
    
    <!-- Define completed state -->
    <state name="COMPLETED">
        <!-- Completed state is a terminal state, no actions defined -->
    </state>
    
    <!-- Define fail state -->
    <state name="FAIL">
        <!-- Can execute retry action in fail state -->
        <action name="retry" ref="retryAction">
            <next-state response="SUCCESS" state="PROCESSING"/>
        </action>
    </state>
</state-machine>